<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>librk4: LibRK4</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">librk4
   </div>
   <div id="projectbrief">A simple RK4 Integration scheme</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LibRK4 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A simple step of Runge-Kutta 4 integration.</p>
<h2>Description</h2>
<p>The library implements a Runge-Kutta 4 scheme with the following tableau: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; 0  |  0   0   0   0</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;1/2 | 1/2  0   0   0</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;1/2 |  0  1/2  0   0</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; 1  |  0   0   1   0</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;----+----------------</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    | 1/6 1/3 1/3 1/6</div></div><!-- fragment --><p> For the ode in the form:</p>
<div class="image">
<img src="https://latex.codecogs.com/gif.latex?\dot{x}(t)&space;=&space;f(t,&space;x(t),&space;u(t),&space;p),&space;\quad&space;x(t_0)&space;=&space;x_0"  title="\dot{x}(t) = f(t, x(t), u(t), p), \quad x(t_0) = x_0"/>
</div>
<p>The integration scheme evaluates:</p>
<div class="image">
<img src="https://latex.codecogs.com/gif.latex?x(t_k&space;&plus;&space;h)&space;=&space;x(t_k)&space;&plus;&space;h&space;\sum_{i&space;=&space;1}^{4}&space;b_i&space;k_i"  title="x(t_k + h) = x(t_k) + h \sum_{i = 1}^{4} b_i k_i"/>
</div>
<p>where:</p>
<div class="image">
<img src="https://latex.codecogs.com/gif.latex?k_i&space;=&space;f(t&space;&plus;&space;c_i&space;h,&space;x(t_k)&space;&plus;&space;h&space;\sum_{j=1}^{i-1}&space;a_{i,j}&space;k_j,&space;u(t_k),&space;p)"  title="k_i = f(t + c_i h, x(t_k) + h \sum_{j=1}^{i-1} a_{i,j} k_j, u(t_k), p)"/>
</div>
<p>The input <em>u(t)</em> is assumed constant between integration ministeps. From an implementation point of view, <em>p</em> is a vector of vectors. This is done for compatibility with MATLAB System Identification Toolbox model file. Since we usually don't have an initialization and a termination callback, everything must be handled inside the integrator step (<code>malloc</code> and <code>free</code> included).</p>
<p>## Examples</p>
<p>### Ode 1st order:</p>
<p>To represent an ODE in the form:</p>
<div class="image">
<img src="https://latex.codecogs.com/gif.latex?\dot{x}&space;=&space;-x&space;&plus;&space;u,&space;\quad&space;x(0)&space;=&space;0"  title="\dot{x} = -x + u, \quad x(0) = 0"/>
</div>
<p>it is necessary to define the following vector field:</p>
<p>``` c void ode(double *xdot, /**&lt; Output of the vector field */ double t, /**&lt; Current time */ const double *x, /**&lt; Current state vector */ const double *u, /**&lt; Input vecotr */ const double <b>p, /</b>&lt; Vector of vectors of parameters */ void *data) /**&lt; Space for user data */ { xdot[0] = -p[0][0] * x[0] + p[1][0] * u[0]; } ``` and the options for the integrator: ``` c <a class="el" href="librk4_8h.html#structrk4__opts" title="Integrator options. ">rk4_opts</a> options = { 1e-3, /**&lt; Time steps */ 1, /**&lt; vector field dimensions */ ode /**&lt; vector field callback (to evaluate it) */ }; ``` a single integration step can be performed as follows: ``` c rk4(&amp;options, xp, t, x, u, p, NULL); ``<code> The last</code>NULL<code>is userdata placeholder (the callback does not use it). The complete code is in [</code>test_ode_1`](test/test_ode_1.c). The result of the integration:</p>
<div class="image">
<img src=".images/ode1.png?raw=true"  alt="Ode 1"/>
</div>
<p>### Ode 2nd order:</p>
<p>To represent an ODE in the form:</p>
<div class="image">
<img src="https://latex.codecogs.com/gif.latex?\begin{array}{rll}&space;\dot{x}_1&space;&=&space;x_2,&space;&&space;x_1(0)&space;=&space;0&space;\\&space;\dot{x}_2&space;&=&space;-&space;p_1\,&space;x_1&space;-&space;p_2\,&space;x_2&space;&plus;&space;p_3\,&space;u&space;,&space;&&space;x_2(0)&space;=&space;0&space;\\&space;\end{array}"  title="\begin{array}{rll} \dot{x}_1 &amp;= x_2, &amp; x_1(0) = 0 \\ \dot{x}_2 &amp;= - p_1\, x_1 - p_2\, x_2 + p_3\, u , &amp; x_2(0) = 0 \\ \end{array}"/>
</div>
<p>it is necessary to define the following vector field:</p>
<p>``` c void ode(double *xdot, /**&lt; Output of the vector field */ double t, /**&lt; Current time */ const double *x, /**&lt; Current state vector */ const double *u, /**&lt; Input vecotr */ const double <b>p, /</b>&lt; Vector of vectors of parameters */ void *data) /**&lt; Space for user data */ { xdot[0] = x[1]; xdot[1] = -p[0][0] * x[0] - p[0][1] * x[1] + p[1][0] * u[0]; } ``` and the options for the integrator: ``` c <a class="el" href="librk4_8h.html#structrk4__opts" title="Integrator options. ">rk4_opts</a> options = { 1e-3, /**&lt; Time steps */ 2, /**&lt; vector field dimensions */ ode /**&lt; vector field callback (to evaluate it) */ }; ``` a single integration step can be performed as follows: ``` c rk4(&amp;options, xp, t, x, u, p, NULL); ``<code> The complete code is in [</code>test_ode_2`](test/test_ode_2.c). The result of the integration:</p>
<div class="image">
<img src=".images/ode2.png?raw=true"  alt="Ode 2"/>
</div>
<p>### Non-linear ODE</p>
<p>To represent an ODE in the form:</p>
<div class="image">
<img src="https://latex.codecogs.com/gif.latex?\dot{x}&space;=&space;(1&space;-2\,&space;t)&space;\,x_1^2"  title="\dot{x} = (1 -2\, t) \,x_1^2"/>
</div>
<p>it is necessary to define the following vector field (in this case we are evaluating the same ODE with 3 different initial conditions):</p>
<p>``` c void ode(double *xdot, /**&lt; Output of the vector field */ double t, /**&lt; Current time */ const double *x, /**&lt; Current state vector */ const double *u, /**&lt; Input vecotr */ const double <b>p, /</b>&lt; Vector of vectors of parameters */ void *data) /**&lt; Space for user data */ { for (size_t i = 0; i &lt; 3; i++) xdot[i] = (1 - 2 * t) * x[i] * x[i]; } ``` and the options for the integrator: ``` c <a class="el" href="librk4_8h.html#structrk4__opts" title="Integrator options. ">rk4_opts</a> options = { 1e-5, /**&lt; Time steps */ 3, /**&lt; vector field dimensions */ ode /**&lt; vector field callback (to evaluate it) */ }; ``` a single integration step can be performed as follows (there is no input and no parameter): ``` c rk4(&amp;options, xp, t, x, NULL, NULL, NULL); ``<code> The complete code is in [</code>test_ode_3`](test/test_ode_3.c). The result of the integration:</p>
<div class="image">
<img src=".images/ode3.png?raw=true"  alt="Ode 3"/>
</div>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
